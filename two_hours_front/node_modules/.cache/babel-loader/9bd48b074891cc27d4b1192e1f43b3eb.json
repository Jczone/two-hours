{"ast":null,"code":"import \"core-js/modules/es.array.slice.js\";\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n\n/**\r\n * Parse and decode geo json\r\n */\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport { GeoJSONLineStringGeometry, GeoJSONPolygonGeometry, GeoJSONRegion } from './Region.js';\n\nfunction decode(json) {\n  if (!json.UTF8Encoding) {\n    return json;\n  }\n\n  var jsonCompressed = json;\n  var encodeScale = jsonCompressed.UTF8Scale;\n\n  if (encodeScale == null) {\n    encodeScale = 1024;\n  }\n\n  var features = jsonCompressed.features;\n  zrUtil.each(features, function (feature) {\n    var geometry = feature.geometry;\n    var encodeOffsets = geometry.encodeOffsets;\n    var coordinates = geometry.coordinates; // Geometry may be appeded manually in the script after json loaded.\n    // In this case this geometry is usually not encoded.\n\n    if (!encodeOffsets) {\n      return;\n    }\n\n    switch (geometry.type) {\n      case 'LineString':\n        geometry.coordinates = decodeRing(coordinates, encodeOffsets, encodeScale);\n        break;\n\n      case 'Polygon':\n        decodeRings(coordinates, encodeOffsets, encodeScale);\n        break;\n\n      case 'MultiLineString':\n        decodeRings(coordinates, encodeOffsets, encodeScale);\n        break;\n\n      case 'MultiPolygon':\n        zrUtil.each(coordinates, function (rings, idx) {\n          return decodeRings(rings, encodeOffsets[idx], encodeScale);\n        });\n    }\n  }); // Has been decoded\n\n  jsonCompressed.UTF8Encoding = false;\n  return jsonCompressed;\n}\n\nfunction decodeRings(rings, encodeOffsets, encodeScale) {\n  for (var c = 0; c < rings.length; c++) {\n    rings[c] = decodeRing(rings[c], encodeOffsets[c], encodeScale);\n  }\n}\n\nfunction decodeRing(coordinate, encodeOffsets, encodeScale) {\n  var result = [];\n  var prevX = encodeOffsets[0];\n  var prevY = encodeOffsets[1];\n\n  for (var i = 0; i < coordinate.length; i += 2) {\n    var x = coordinate.charCodeAt(i) - 64;\n    var y = coordinate.charCodeAt(i + 1) - 64; // ZigZag decoding\n\n    x = x >> 1 ^ -(x & 1);\n    y = y >> 1 ^ -(y & 1); // Delta deocding\n\n    x += prevX;\n    y += prevY;\n    prevX = x;\n    prevY = y; // Dequantize\n\n    result.push([x / encodeScale, y / encodeScale]);\n  }\n\n  return result;\n}\n\nexport default function parseGeoJSON(geoJson, nameProperty) {\n  geoJson = decode(geoJson);\n  return zrUtil.map(zrUtil.filter(geoJson.features, function (featureObj) {\n    // Output of mapshaper may have geometry null\n    return featureObj.geometry && featureObj.properties && featureObj.geometry.coordinates.length > 0;\n  }), function (featureObj) {\n    var properties = featureObj.properties;\n    var geo = featureObj.geometry;\n    var geometries = [];\n\n    switch (geo.type) {\n      case 'Polygon':\n        var coordinates = geo.coordinates; // According to the GeoJSON specification.\n        // First must be exterior, and the rest are all interior(holes).\n\n        geometries.push(new GeoJSONPolygonGeometry(coordinates[0], coordinates.slice(1)));\n        break;\n\n      case 'MultiPolygon':\n        zrUtil.each(geo.coordinates, function (item) {\n          if (item[0]) {\n            geometries.push(new GeoJSONPolygonGeometry(item[0], item.slice(1)));\n          }\n        });\n        break;\n\n      case 'LineString':\n        geometries.push(new GeoJSONLineStringGeometry([geo.coordinates]));\n        break;\n\n      case 'MultiLineString':\n        geometries.push(new GeoJSONLineStringGeometry(geo.coordinates));\n    }\n\n    var region = new GeoJSONRegion(properties[nameProperty || 'name'], geometries, properties.cp);\n    region.properties = properties;\n    return region;\n  });\n}","map":{"version":3,"sources":["F:/Desktop/繁星教育/TH资料/two_hours_front/node_modules/echarts/lib/coord/geo/parseGeoJson.js"],"names":["zrUtil","GeoJSONLineStringGeometry","GeoJSONPolygonGeometry","GeoJSONRegion","decode","json","UTF8Encoding","jsonCompressed","encodeScale","UTF8Scale","features","each","feature","geometry","encodeOffsets","coordinates","type","decodeRing","decodeRings","rings","idx","c","length","coordinate","result","prevX","prevY","i","x","charCodeAt","y","push","parseGeoJSON","geoJson","nameProperty","map","filter","featureObj","properties","geo","geometries","slice","item","region","cp"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n\n/**\r\n * Parse and decode geo json\r\n */\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport { GeoJSONLineStringGeometry, GeoJSONPolygonGeometry, GeoJSONRegion } from './Region.js';\n\nfunction decode(json) {\n  if (!json.UTF8Encoding) {\n    return json;\n  }\n\n  var jsonCompressed = json;\n  var encodeScale = jsonCompressed.UTF8Scale;\n\n  if (encodeScale == null) {\n    encodeScale = 1024;\n  }\n\n  var features = jsonCompressed.features;\n  zrUtil.each(features, function (feature) {\n    var geometry = feature.geometry;\n    var encodeOffsets = geometry.encodeOffsets;\n    var coordinates = geometry.coordinates; // Geometry may be appeded manually in the script after json loaded.\n    // In this case this geometry is usually not encoded.\n\n    if (!encodeOffsets) {\n      return;\n    }\n\n    switch (geometry.type) {\n      case 'LineString':\n        geometry.coordinates = decodeRing(coordinates, encodeOffsets, encodeScale);\n        break;\n\n      case 'Polygon':\n        decodeRings(coordinates, encodeOffsets, encodeScale);\n        break;\n\n      case 'MultiLineString':\n        decodeRings(coordinates, encodeOffsets, encodeScale);\n        break;\n\n      case 'MultiPolygon':\n        zrUtil.each(coordinates, function (rings, idx) {\n          return decodeRings(rings, encodeOffsets[idx], encodeScale);\n        });\n    }\n  }); // Has been decoded\n\n  jsonCompressed.UTF8Encoding = false;\n  return jsonCompressed;\n}\n\nfunction decodeRings(rings, encodeOffsets, encodeScale) {\n  for (var c = 0; c < rings.length; c++) {\n    rings[c] = decodeRing(rings[c], encodeOffsets[c], encodeScale);\n  }\n}\n\nfunction decodeRing(coordinate, encodeOffsets, encodeScale) {\n  var result = [];\n  var prevX = encodeOffsets[0];\n  var prevY = encodeOffsets[1];\n\n  for (var i = 0; i < coordinate.length; i += 2) {\n    var x = coordinate.charCodeAt(i) - 64;\n    var y = coordinate.charCodeAt(i + 1) - 64; // ZigZag decoding\n\n    x = x >> 1 ^ -(x & 1);\n    y = y >> 1 ^ -(y & 1); // Delta deocding\n\n    x += prevX;\n    y += prevY;\n    prevX = x;\n    prevY = y; // Dequantize\n\n    result.push([x / encodeScale, y / encodeScale]);\n  }\n\n  return result;\n}\n\nexport default function parseGeoJSON(geoJson, nameProperty) {\n  geoJson = decode(geoJson);\n  return zrUtil.map(zrUtil.filter(geoJson.features, function (featureObj) {\n    // Output of mapshaper may have geometry null\n    return featureObj.geometry && featureObj.properties && featureObj.geometry.coordinates.length > 0;\n  }), function (featureObj) {\n    var properties = featureObj.properties;\n    var geo = featureObj.geometry;\n    var geometries = [];\n\n    switch (geo.type) {\n      case 'Polygon':\n        var coordinates = geo.coordinates; // According to the GeoJSON specification.\n        // First must be exterior, and the rest are all interior(holes).\n\n        geometries.push(new GeoJSONPolygonGeometry(coordinates[0], coordinates.slice(1)));\n        break;\n\n      case 'MultiPolygon':\n        zrUtil.each(geo.coordinates, function (item) {\n          if (item[0]) {\n            geometries.push(new GeoJSONPolygonGeometry(item[0], item.slice(1)));\n          }\n        });\n        break;\n\n      case 'LineString':\n        geometries.push(new GeoJSONLineStringGeometry([geo.coordinates]));\n        break;\n\n      case 'MultiLineString':\n        geometries.push(new GeoJSONLineStringGeometry(geo.coordinates));\n    }\n\n    var region = new GeoJSONRegion(properties[nameProperty || 'name'], geometries, properties.cp);\n    region.properties = properties;\n    return region;\n  });\n}"]},"metadata":{},"sourceType":"module"}